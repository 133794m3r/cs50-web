{% extends 'layout.html' %}
{% load static %}
{% block head %}
	<script type="application/javascript">
		document.addEventListener('DOMContentLoaded',function(){
			document.querySelectorAll('.make_challenge').forEach(el=>{
				el.addEventListener("click",event=>{
						modal_challenge(event,el.dataset.sn,el.dataset.edit);
				});
			});
			document.getElementById('submit_chal').addEventListener("click",event=>{
				event.preventDefault()
				submit_challenge()
			});

		});
		let CHALLENGES = {};
		{{ json | safe }}.forEach(chal=>{
			CHALLENGES[chal.sn] = chal;
		})
		FULL_CHALLENGES = {{ json | safe }};


	</script>
	<script src="{% static 'js/admin.js' %}" type="application/javascript"></script>
{% endblock %}
{% block body %}
	<div class="container-lg container mt-3">
		<div class="row">
		{% for challenge in challenges %}
			{% if not challenge.variety %}
			<div class="col-md-4">
				<div class="card text-white bg-secondary mb-3">
					<div class="card-header">
						<span>{{ challenge.name }}</span>
					</div>
					<div class="card-title ml-2">
						{{ challenge.category }}
					</div>
					<div class="card-body">
						{{ challenge.description }}
					</div>
					<div class="card-footer">
						{% if challenge.edit == True %}
							<a href="#" class="btn btn-dark make_challenge" data-sn="{{ challenge.sn }}" data-edit="true">Edit Challenge</a>
						{% else %}
							<a href="#" class="btn btn-dark make_challenge" data-sn="{{ challenge.sn }}" data-edit="false">Create Challenge</a>
						{% endif %}
					</div>
				</div>
			</div>
			{% endif %}
		{% endfor %}
		</div>
	</div>

	<div class="modal fade" id="challenge_modal" tabindex="-1" role="dialog" aria-labelledby="modal_title" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="challenge_modal_title"></h5>
			 	 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					 <span aria-hidden="true">&times;</span>
			 	 </button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-11">
							<span id="input_description"></span>
							<div id="full_description"></div>
						</div>
					</div>
					<div class="row" id="input_row">

					</div>
					<input type="text" class="hidden" name="sn" id="sn" />
					<input type="checkbox" class="hidden" name="editing" id="editing" />
				</div>
				<div class="modal-footer">
					<button id="submit_chal" type="button" class="btn btn-secondary" data-dismiss="modal">Submit Challenge</button>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
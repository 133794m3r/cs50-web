{% extends 'layout.html' %}
{% block head %}
	<script type="application/javascript">
		document.addEventListener('DOMContentLoaded',function(){
			document.querySelectorAll('.make_challenge').forEach(el=>{
				console.log(el);
				el.addEventListener("click",event=>{
						modal_challenge(event,el.dataset.sn,el.innerText);
				})
			})
		});
		let CHALLENGES = {};
		{{  json | safe}}.forEach(chal=>{
			CHALLENGES[chal.sn] = chal;
		})
		function modal_challenge(event,challenge_type){
			event.preventDefault();
			let inner_content;


			switch(challenge_type){
				case "fizzbuzz":
					inner_content=`<div class="col-6">
						<div class="modal-input input-group mb-3">
							<div class="input-group-prepend">
								<label for="min" class="input-group-text">
								Min
								</label>
							</div>
							<input type="text" name="min" id="min" class="input_items"/>
						</div>
						<div class="modal-input input-group mb-3">
							<div class="input-group-prepend">
								<label for="max" class="input-group-text">
								Max
								</label>
							</div>
							<input type="text" name="max" id="max" class="input_items"/>
						</div>
					</div>`
					break;
				default:
					inner_content=`<div class="col-6 form-group">
						<textarea id='plain_text' name='plain_text' class="input_items form-text" rows="3" cols="40"></textarea>
					</div>`
					 if(challenge_type === 'hill' || challenge_type === 'affine'){
					 	inner_content += `<div class="col-6 form-group">
							<select><option value="1">Easy</option>
							<option value="2">Hard</option></select>`
					 }
					break;
			}
			let chal = CHALLENGES[challenge_type]
			document.getElementById('input_description').innerText = chal.description;

			document.getElementById('challenge_modal_title').innerText = `${chal.name} -- Category:${chal.category}`;
			document.getElementById('input_row').innerHTML = inner_content;
			console.log('test')
			$('#challenge_modal').modal('toggle')
		}
	</script>
{% endblock %}
{% block body %}
	<div class="container-lg container">
		<div class="row">
		{% for challenge in challenges %}
			<div class="col-4">
				<a href="#" class="make_challenge" data-sn="{{ challenge.sn }}">{{ challenge.name }}</a>
			</div>
		{% endfor %}
		</div>
	</div>

	<div class="modal fade" id="challenge_modal" tabindex="-1" role="dialog" aria-labelledby="modal_title" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="challenge_modal_title"></h5>
			 	 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					 <span aria-hidden="true">&times;</span>
			 	 </button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-11">
							<span id="input_description"></span>
						</div>
					</div>
					<div class="row" id="input_row">

					</div>
				</div>
				<div class="modal-footer">
					<button id="close_button" type="button" class="btn btn-secondary" data-dismiss="modal" disabled>Submit Challenge</button>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
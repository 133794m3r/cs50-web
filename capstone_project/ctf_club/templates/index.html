{% extends 'layout.html' %}
{% load static %}
{% block head %}
	<script type="text/javascript" src="{% static '/js/client.js' %}"></script>
	<script type="text/javascript">
		document.addEventListener('DOMContentLoaded',function(){
			document.querySelectorAll('.view_challenge').forEach(el=>{
				el.addEventListener('click',()=>{
					fetch_chal(el.dataset.id);
				})
			})
			 document.getElementById('solve_chal').addEventListener('click',event=>{
			 	solve(event)
			 });
		})
	</script>
{% endblock %}
{% block body %}
	<div class="container-lg">
		<div class="row">
			<div class="col-12">
				<br />
				Below you can see all of the challenges broken up into different categories. Select a challenge to attempt to solve it.
				Note that you have to be signed-in to have your solves be remembered. You can attempt any challenge as a guest user though.
				Hints require you to be signed in for all but the one that's included in the challenge itself.
			</div>
		</div>
		<br />
		{% comment %}
			The code below goes over the objects that are passed to it(a dict) which is indexed based upon the category.
			The category is then used as a header for the category. The challenges that are contained are then parsed
			and added to the page.

		{% endcomment %}
		{% for category,challenges in objects.items %}
			<div class="row">
				<div class="col-md-12 mb-3">
					<h2>
						{{ category }}
					</h2>
				</div>
			{% for challenge in challenges %}
				<div class="col-md-4">
				{# The button below will eventually call the /chal route and get the challenge's information more likely than not. #}
					<button id="challenge_{{ challenge.id }}" class="w-100 view_challenge btn btn-secondary mb-2 pt-2 p-3" data-id="{{ challenge.id }}">
						{{ challenge.name }}
					</button>
				</div>
				{% endfor %}
			</div>
		{% endfor %}

	</div>
	<div class="modal fade" id="challenge_modal" tabindex="-1" role="dialog" aria-labelledby="modal_title" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h2 class="modal-title text-center" id="challenge_modal_title"></h2>
				 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					 <span aria-hidden="true">&times;</span>
				 </button>
				</div>
				<div class="modal-body">
					<div class="row m-2">
						<div class="col-11 text-center">
							<h3 id="points"></h3>
						</div>
					</div>
					<div class="row">
						<div class="col-11" id="description">
						</div>
					</div>
					<div class="row" id="input_row">
						<div class="col-3">
							<input id="answer" type="text" />
							<input id="challenge_id" type="text" aria-hidden="true" class="hidden" />
							{% csrf_token %}
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button id="solve_chal" type="button" class="btn btn-secondary">Attempt Solve</button>
				</div>
			</div>
		</div>
	</div>
{% endblock %}